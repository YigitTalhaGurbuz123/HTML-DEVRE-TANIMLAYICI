<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Programcının Günlüğü</title>
    <link rel="stylesheet" href="../static/css/style.css" />
</head>
<body>
    <header class="header">
        <a href="/not_defteri">
            <img src="../static/img/logo.svg" alt="logo" width="30" height="30" />
        </a>
        <ul class="main-list">
            <li class="list__item">
                <a href="/">
                    <img src="../static/img/login.svg" alt="login" width="20" height="20" />
                </a>
            </li>
        </ul>
    </header>

    <main>
        {% block content %}
        <form action="{{ url_for('form_create') }}" method="post" class="creat-form">
            <div class="form__card">
                <img class="card__img" src="../static/img/post_icon.png" width="250" height="250" alt="post_icon" />
                <div class="form__inputs">
                    <label for="title">
                        <input
                            class="form__input"
                            type="text"
                            name="title"
                            id="title"
                            placeholder="Girdinin başlığını girin"
                            required
                            value="{{ title or '' }}"
                        />
                    </label>
                    <label for="subtitle">
                        <input
                            class="form__input"
                            type="text"
                            name="subtitle"
                            id="subtitle"
                            placeholder="Girdinin açıklamasını girin"
                            required
                            value="{{ subtitle or '' }}"
                        />
                    </label>
                </div>

                <label for="text">
                    <textarea
                        class="form__text"
                        name="text"
                        id="text"
                        cols="30"
                        rows="10"
                        required
                        placeholder="Girdiyi buraya yazın..."
                    >{{ text or '' }}</textarea>
                </label>

                <div style="margin-top: 15px;">
                    <button type="button" id="start-record-btn">Kayıt (TR)</button>
                    <button type="button" id="start-record-en-btn">Kayıt (EN)</button>
                    <button type="button" onclick="window.location.href='https://yigittalhagurbuz123.github.io/Korsan-Avi-Sitesi/oyun.html'">Oyuna Git</button>
                </div>

                <button class="form__button" type="submit" style="margin-top: 20px;">Oluştur</button>
            </div>
        </form>
        {% endblock %}
    </main>

    <script>
        const startRecordBtn = document.getElementById('start-record-btn');
        const startRecordEnBtn = document.getElementById('start-record-en-btn');
        const textArea = document.getElementById('text');

        function startRecognition(lang) {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Tarayıcınız bu özelliği desteklemiyor!');
                return;
            }

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();

            recognition.lang = lang;
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            recognition.start();

            recognition.onresult = (event) => {
                const speechResult = event.results[0][0].transcript;
                textArea.value = speechResult;
            };

            recognition.onerror = () => {
                alert('Ses algılanamadı, tekrar deneyin.');
            };
        }

        startRecordBtn.addEventListener('click', () => startRecognition('tr-TR'));
        startRecordEnBtn.addEventListener('click', () => startRecognition('en-GB'));
    </script>
</body>
</html>
